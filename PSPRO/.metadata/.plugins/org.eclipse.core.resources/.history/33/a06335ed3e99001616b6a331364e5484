import java.util.ArrayList;
import java.util.Random;
import java.util.Vector;

class Baton {
	
	private volatile boolean haveBaton = true;
	
	public boolean batonState(){
		
		return this.haveBaton;
	}
	
	public void chageBatonState(boolean state){
		
		this.haveBaton = state;
	}
	
}

public class Relay {
	
	private static Runner[] runners = new Runner[4];
    
    public static boolean endRace = false;

	public static void main(String[] args) {
		
		startUI();
	}

	private static void startUI() {
	
		Baton baton = new Baton();
		ArrayList<String> runnersName = new ArrayList<String>();
		Random random = new Random();
		String nameRunner;
		int numberRandom;
		runnersName.add("Pepe");
		runnersName.add("Juanito");
		runnersName.add("Ernesto");
		runnersName.add("Juaquin");
		
		
		
		for (int i = 0; i < runners.length; i++) {
			
			numberRandom = random.nextInt(runnersName.size());
			nameRunner = runnersName.get(numberRandom);
			runnersName.remove(numberRandom);
			runners[i] = new Runner(baton, nameRunner);
			runners[i].start();
		}
		
		try{
			for (int i = 0; i < runners.length; i++) {
					runners[i].join();
				
				}
		
		Thread.sleep(500);
		System.out.println("End of race");
		
		}catch (InterruptedException e) {
			
			
		}
	}
		
	}	
	
}



class Runner extends Thread{
	
	private Baton baton;
	private String nameRunner;
	
	public Runner(Baton b, String nameRunner){
		
		this.baton = b;	
		this.nameRunner = nameRunner;
	}
	
	public void runnig(){
		
		synchronized (this.baton) {
			
			this.baton.chageBatonState(false);			
		}
		
	}
	
	public void endturn(){
		
		synchronized (this.baton) {
			
			this.baton.chageBatonState(true);
		}
	}
	
	public boolean botonState(){
		
		synchronized (this.baton) {
			
		    return this.baton.batonState();
			
		}
	}
	
	public void run(){
		
		try{
			
			
			
				while (!botonState()) {
					Thread.sleep(1);
				}
				runnig();
				System.out.println("[Runner "+this.nameRunner+"]"+"End of my time");
				Thread.sleep(2000);				
				endturn();				
					
		}catch(IllegalArgumentException | InterruptedException e){
			
			//????
		}
		
	}
	
	
}
